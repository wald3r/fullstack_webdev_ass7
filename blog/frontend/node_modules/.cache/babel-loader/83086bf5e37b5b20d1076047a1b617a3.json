{"ast":null,"code":"import _slicedToArray from \"/home/walder/workspaces/fullstack_webdev/fullstack_webdev_ass7/blog/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/home/walder/workspaces/fullstack_webdev/fullstack_webdev_ass7/blog/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/home/walder/workspaces/fullstack_webdev/fullstack_webdev_ass7/blog/frontend/src/App.js\";\n\n/* eslint-disable no-unused-labels */\nimport React, { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport Notification from './components/Notification';\nimport Error from './components/Error';\nimport LoginForm from './components/LoginForm';\nimport AddBlogForm from './components/AddBlogForm';\nimport Togglable from './components/Togglable';\nimport { useUsername, usePassword } from './hooks';\nimport { initBlogs, addNewBlog, likeBlog, removeBlog } from './reducers/blogReducer';\nimport { handleNotification } from './reducers/notificationReducer';\nimport { setUser, removeUser } from './reducers/userReducer';\nimport { handleError } from './reducers/errorReducer';\nimport { connect } from 'react-redux';\nimport loginService from './services/login';\nimport blogService from './services/blogs';\nimport { BrowserRouter as Router, Route, Link, Redirect, withRouter } from 'react-router-dom';\nimport UserInformation from './components/UserInformation';\n\nconst App = props => {\n  const _useUsername = useUsername('username'),\n        resetusername = _useUsername.resetusername,\n        username = _objectWithoutProperties(_useUsername, [\"resetusername\"]);\n\n  const _usePassword = usePassword('password'),\n        resetpasswd = _usePassword.resetpasswd,\n        password = _objectWithoutProperties(_usePassword, [\"resetpasswd\"]);\n\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        user = _useState2[0],\n        setUser = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        title = _useState4[0],\n        setTitle = _useState4[1];\n\n  const _useState5 = useState(''),\n        _useState6 = _slicedToArray(_useState5, 2),\n        author = _useState6[0],\n        setAuthor = _useState6[1];\n\n  const _useState7 = useState(''),\n        _useState8 = _slicedToArray(_useState7, 2),\n        url = _useState8[0],\n        setUrl = _useState8[1];\n\n  const padding = {\n    padding: 5\n  };\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogappUser');\n\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON);\n      setUser(user);\n      window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user));\n      blogService.setToken(user.token); //props.setUser(user)\n\n      props.initBlogs();\n      setTitle('');\n      setAuthor('');\n      setUrl('');\n    }\n  }, [props]);\n\n  const handleLogout = () => {\n    try {\n      //props.removeUser()\n      window.localStorage.removeItem('loggedBlogappUser');\n      props.handleNotification('Logout successfully, 5000');\n    } catch (exception) {\n      props.handleError('Logout failed!', 5000);\n    }\n  };\n\n  if (user === null) {\n    return React.createElement(LogIn, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    });\n  } else {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, username.value, \" is logged in\", React.createElement(\"button\", {\n      onClick: handleLogout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, \"logout\")), React.createElement(Router, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => React.createElement(Home, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/users\",\n      render: () => React.createElement(UserInformation, {\n        username: username,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    })));\n  }\n};\n\nconst LogIn = () => {\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, React.createElement(Notification, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }), React.createElement(Error, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }), React.createElement(LoginForm, {\n    username: username,\n    password: password,\n    handleSubmit: handleLogin,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }));\n};\n\nconst Home = props => {\n  const handleLogin = async event => {\n    event.preventDefault();\n\n    try {\n      const newUser = await loginService.login({\n        username: username.value,\n        password: password.value\n      }); //await props.setUser(username, password)\n\n      setUser(newUser);\n      window.localStorage.setItem('loggedBlogappUser', JSON.stringify(newUser));\n      blogService.setToken(newUser.token);\n      props.handleNotification('Login successfull!', 5000);\n      resetusername();\n      resetpasswd();\n    } catch (exception) {\n      props.handleError('Login failed!', 5000);\n      resetusername();\n      resetpasswd();\n    }\n  };\n\n  const handleAddBlog = event => {\n    event.preventDefault();\n    console.log('adding blog', title, author, url);\n    const newBlog = {\n      title: title,\n      author: author,\n      url: url\n    };\n    props.addNewBlog(newBlog);\n    props.handleNotification(\"a new blog \".concat(title, \" by \").concat(author, \" added\"), 5000);\n    setAuthor('');\n    setTitle('');\n    setUrl('');\n    window.location.reload();\n  };\n\n  const handleLikes = blog => {\n    props.likeBlog(blog);\n    props.handleNotification(\"you liked blog \".concat(blog.title, \" from author \").concat(blog.author), 5000);\n  };\n\n  const handleRemoval = blog => {\n    const result = window.confirm(\"Do you really want to delete blog \".concat(blog.title, \"?\"));\n\n    if (result) {\n      props.removeBlog(blog);\n      props.handleNotification(\"blog \".concat(blog.title, \" by \").concat(blog.author, \" got deleted\"), 5000);\n    }\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, React.createElement(Notification, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }), React.createElement(Error, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, React.createElement(Togglable, {\n    buttonLabel: \"new Blog\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, React.createElement(AddBlogForm, {\n    author: author,\n    title: title,\n    url: url,\n    handleAuthorChange: ({\n      target\n    }) => setAuthor(target.value),\n    handleTitleChange: ({\n      target\n    }) => setTitle(target.value),\n    handleUrlChange: ({\n      target\n    }) => setUrl(target.value),\n    handleAddBlog: handleAddBlog,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }))), React.createElement(\"ul\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, props.blogs.map(blog => React.createElement(Blog, {\n    key: blog.id,\n    blog: blog,\n    handleRemoval: () => handleRemoval(blog),\n    handleLikes: () => handleLikes(blog),\n    user: user,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }))));\n};\n\nconst mapStateToProps = state => {\n  return {\n    blogs: state.blogs,\n    notification: state.notification,\n    error: state.error,\n    user: state.user\n  };\n};\n\nconst mapDispatchToProps = {\n  initBlogs,\n  addNewBlog,\n  likeBlog,\n  removeBlog,\n  handleNotification,\n  handleError,\n  setUser,\n  removeUser\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","map":{"version":3,"sources":["/home/walder/workspaces/fullstack_webdev/fullstack_webdev_ass7/blog/frontend/src/App.js"],"names":["React","useState","useEffect","Blog","Notification","Error","LoginForm","AddBlogForm","Togglable","useUsername","usePassword","initBlogs","addNewBlog","likeBlog","removeBlog","handleNotification","setUser","removeUser","handleError","connect","loginService","blogService","BrowserRouter","Router","Route","Link","Redirect","withRouter","UserInformation","App","props","resetusername","username","resetpasswd","password","user","title","setTitle","author","setAuthor","url","setUrl","padding","loggedUserJSON","window","localStorage","getItem","JSON","parse","setItem","stringify","setToken","token","handleLogout","removeItem","exception","value","LogIn","handleLogin","Home","event","preventDefault","newUser","login","handleAddBlog","console","log","newBlog","location","reload","handleLikes","blog","handleRemoval","result","confirm","target","blogs","map","id","mapStateToProps","state","notification","error","mapDispatchToProps"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-labels */\nimport React, { useState, useEffect } from 'react'\nimport Blog from './components/Blog'\nimport Notification from './components/Notification'\nimport Error from './components/Error'\nimport LoginForm from './components/LoginForm'\nimport AddBlogForm from './components/AddBlogForm'\nimport Togglable from './components/Togglable'\nimport { useUsername, usePassword } from './hooks'\nimport { initBlogs, addNewBlog, likeBlog, removeBlog } from './reducers/blogReducer'\nimport { handleNotification } from './reducers/notificationReducer'\nimport { setUser, removeUser } from './reducers/userReducer'\nimport { handleError } from './reducers/errorReducer'\nimport { connect } from 'react-redux'\nimport loginService from './services/login'\nimport blogService from './services/blogs'\nimport {BrowserRouter as Router, Route, Link, Redirect, withRouter} from 'react-router-dom'\nimport UserInformation from './components/UserInformation'\n\nconst App = ( props ) => {\n\n    const { resetusername, ...username } = useUsername('username')\n    const { resetpasswd, ...password } = usePassword('password')\n    const [user, setUser] = useState(null)\n    const [title, setTitle] = useState('')\n    const [author, setAuthor] = useState('')\n    const [url, setUrl] = useState('')\n\n    const padding = {padding : 5}\n\n    useEffect(() => {\n        const loggedUserJSON = window.localStorage.getItem('loggedBlogappUser')\n        if (loggedUserJSON) {\n            const user = JSON.parse(loggedUserJSON)\n            setUser(user)\n            window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user))\n            blogService.setToken(user.token)\n            //props.setUser(user)\n            props.initBlogs()\n            setTitle('')\n            setAuthor('')\n            setUrl('')\n        }\n    }, [props])\n\n    const handleLogout = () => {\n        try{\n            //props.removeUser()\n            window.localStorage.removeItem('loggedBlogappUser')\n            props.handleNotification('Logout successfully, 5000')\n        }catch(exception){\n            props.handleError('Logout failed!', 5000)\n        }\n    }\n\n    if(user === null){\n        return(\n            <LogIn />\n        )\n    }else{\n        return(\n            <div>\n                <div>\n                    {username.value} is logged in\n                    <button onClick={handleLogout}>logout</button>\n                </div>\n                <Router>\n                    <Route exact path='/' render={() => <Home />} />\n                    <Route path='/users' render={() => <UserInformation username={username} /> } />\n                </Router>\n            </div>\n        )\n    }\n}\n\nconst LogIn = () => {\n    return(\n        <div>\n            <Notification />\n            <Error />\n            <LoginForm\n                username={username}\n                password={password}\n                handleSubmit={handleLogin}\n            />\n        </div>\n    )\n}\n\nconst Home = (props) => {\n\n    \n\n    const handleLogin = async event => {\n        event.preventDefault()\n        try{\n            const newUser = await loginService.login({ username: username.value, password: password.value })\n            //await props.setUser(username, password)\n            setUser(newUser)\n            window.localStorage.setItem('loggedBlogappUser', JSON.stringify(newUser))\n            blogService.setToken(newUser.token)\n            props.handleNotification('Login successfull!', 5000)\n            resetusername()\n            resetpasswd()\n\n        }catch(exception){\n            props.handleError('Login failed!', 5000)\n            resetusername()\n            resetpasswd()\n        }\n\n    }\n\n    const handleAddBlog = event => {\n        event.preventDefault()\n        console.log('adding blog', title, author, url)\n\n        const newBlog = {\n            title: title,\n            author: author,\n            url: url,\n        }\n        props.addNewBlog(newBlog)\n        props.handleNotification(`a new blog ${title} by ${author} added`, 5000)\n        setAuthor('')\n        setTitle('')\n        setUrl('')\n        window.location.reload()\n\n    }\n\n\n    const handleLikes = (blog) => {\n        props.likeBlog(blog)\n        props.handleNotification(`you liked blog ${blog.title} from author ${blog.author}`, 5000)\n    }\n\n\n    const handleRemoval = (blog) => {\n        const result = window.confirm(`Do you really want to delete blog ${blog.title}?`)\n        if(result){\n            props.removeBlog(blog)\n            props.handleNotification(`blog ${blog.title} by ${blog.author} got deleted`, 5000)\n        }\n    }\n\n    return(\n        <div>\n            <Notification  />\n            <Error />\n            <div>\n                <Togglable buttonLabel='new Blog'>\n                    <AddBlogForm\n                        author={author}\n                        title={title}\n                        url={url}\n                        handleAuthorChange={({ target }) => setAuthor(target.value)}\n                        handleTitleChange={({ target }) => setTitle(target.value)}\n                        handleUrlChange={({ target }) => setUrl(target.value)}\n                        handleAddBlog={handleAddBlog}\n                    />\n                </Togglable>\n            </div>\n            <ul>\n                {props.blogs.map(blog =>\n                    <Blog\n                        key={blog.id}\n                        blog={blog}\n                        handleRemoval={() => handleRemoval(blog)}                            \n                        handleLikes={() => handleLikes(blog)}\n                        user={user} /> )}\n            </ul>\n        </div>\n    )\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        blogs: state.blogs,\n        notification: state.notification,\n        error: state.error,\n        user: state.user,\n    }\n}\n\nconst mapDispatchToProps = {\n    initBlogs,\n    addNewBlog,\n    likeBlog,\n    removeBlog,\n    handleNotification,\n    handleError,\n    setUser,\n    removeUser,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App)"]},"metadata":{},"sourceType":"module"}